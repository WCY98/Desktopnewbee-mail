<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper 
       namespace="ltd.newbee.mall.newbeemall.dao.GoodsReviewMapper">
       
      <select id= "findReviewByGoodsId"
         resultType="ltd.newbee.mall.newbeemall.entity.GoodsReview">
         select re.review_id, re.rating, re.nick_name, re.review_date,re.review_content,re.review_title,
         re.review_photo1,re.review_photo2,re.review_photo3,re.review_photo4,re.review_photo5,
         item.goods_name, count(li.review_id) as count
         from review as re 
         join tb_newbee_mall_order_item as item
         on re.order_id = item.order_id
         join review_like as li
         on re.review_id = li.review_id
         where item.goods_id = #{goodsId} and proved = 1
         group by re.review_id
         order by rating DESC
         </select>
         </mapper>